Давайте найду актуальные цены OpenAI API, чтобы корректно рассчитать себестоимость.Отлично, теперь проведем детальный расчет себестоимости для вашего Legal Data Refinery. Буду использовать актуальные цены OpenAI API.## Расчет себестоимости запросов для Legal Data Refinery

Актуальный курс на 17 января 2026: **43.50 грн/USD** (средний курс обменников).

### Цены OpenAI API (актуальные на 2025-2026)

**GPT-4o (основная модель):**
- Input tokens: $2.50 за 1M токенов = **0.109 грн за 1K токенов**
- Output tokens: $10.00 за 1M токенов = **0.435 грн за 1K токенов**

**GPT-4o mini (экономичная версия):**
- Input tokens: $0.15 за 1M токенов = **0.0065 грн за 1K токенов**
- Output tokens: $0.60 за 1M токенов = **0.0261 грн за 1K токенов**

### Сравнительная таблица тарифов

```mermaid
graph TD
    A[Запрос пользователя] --> B[Стоимость компонентов]
    B --> C[ЗаконОнлайн API]
    B --> D[OpenAI GPT-4o]
    B --> E[OpenAI GPT-4o mini]
    
    C --> C1[До 10K: 3000 грн фикс]
    C --> C2[10K-20K: 0.29 грн/запрос]
    C --> C3[20K-30K: 0.28 грн/запрос]
    C --> C4[30K-50K: 0.27 грн/запрос]
    C --> C5[50K+: 0.10 грн/запрос]
    
    D --> D1[Input: 0.109 грн/1K токенов]
    D --> D2[Output: 0.435 грн/1K токенов]
    
    E --> E1[Input: 0.0065 грн/1K токенов]
    E --> E2[Output: 0.0261 грн/1K токенов]
```

### Модель себестоимости типичного запроса

Рассмотрим три сценария использования для вашего Legal Data Refinery.

#### Сценарий 1: Простой поиск судебного решения

**Компоненты:**
- Запрос к ЗаконОнлайн API: получение 1 решения
- Обработка через GPT-4o mini: нормализация и извлечение структурированных данных

**Расчет токенов:**
- Input (промпт + текст решения ~3000 слов): ~4000 токенов
- Output (структурированный JSON): ~500 токенов

**Стоимость:**
- ЗаконОнлайн: 0.29 грн (при объеме 10K-20K запросов/мес)
- GPT-4o mini: (4 × 0.0065) + (0.5 × 0.0261) = 0.026 + 0.013 = **0.039 грн**
- **ИТОГО: 0.33 грн за запрос**

#### Сценарий 2: Построение Legal Graph

**Компоненты:**
- Запрос к ЗаконОнлайн API: получение 10-20 связанных решений
- Обработка через GPT-4o: анализ связей, построение графа, извлечение цитирований

**Расчет токенов:**
- Input (промпт + 15 решений × 3000 слов): ~60000 токенов
- Output (граф связей, описание узлов, рёбер): ~8000 токенов

**Стоимость:**
- ЗаконОнлайн: 15 × 0.29 = 4.35 грн (при объеме 10K-20K)
- GPT-4o: (60 × 0.109) + (8 × 0.435) = 6.54 + 3.48 = **10.02 грн**
- **ИТОГО: 14.37 грн за запрос**

#### Сценарий 3: RAG-запрос с юридическим анализом

**Компоненты:**
- Запрос к ЗаконОнлайн API: поиск релевантных решений по запросу
- Retrieval: векторный поиск в базе (нет доп. стоимости, локально)
- LLM Generation: подробный юридический анализ через GPT-4o

**Расчет токенов:**
- Input (промпт + контекст из 5 решений): ~20000 токенов
- Output (детальный анализ): ~3000 токенов

**Стоимость:**
- ЗаконОнлайн: 5 × 0.29 = 1.45 грн
- GPT-4o: (20 × 0.109) + (3 × 0.435) = 2.18 + 1.31 = **3.49 грн**
- **ИТОГО: 4.94 грн за запрос**

### Анализ ценообразования по объемам

Важный момент: тарифы ЗаконОнлайн имеют **порог входа** в 3000 грн до 10K запросов. Давайте посчитаем break-even points.

**Фиксированный тариф ЗаконОнлайн (до 10K запросов):**
- 3000 грн / 10000 запросов = **0.30 грн за запрос**

Это означает, что при объеме менее 10K запросов/месяц, ваша эффективная стоимость ЗаконОнлайн выше при малом использовании:

- При 1000 запросов/мес: 3000 / 1000 = **3.00 грн за запрос** (ЗаконОнлайн)
- При 5000 запросов/мес: 3000 / 5000 = **0.60 грн за запрос**
- При 10000 запросов/мес: 3000 / 10000 = **0.30 грн за запрос**

### Сравнение с конкурентами

Вы правильно отметили, что боретесь с Harvey и подобными решениями. Давайте сравним value proposition:

**Harvey (типичный запрос):**
- Подключается к Lexis/LexisNexis
- Черный ящик ценообразования
- Ориентировочно: $50-200 за комплексный анализ

**Ваш Legal Data Refinery:**
- Публичные украинские данные (20M+ решений)
- Прозрачное ценообразование
- Себестоимость: 0.33 грн (простой) до 14.37 грн (сложный граф)

**Ваше преимущество:** Вы оперируете с публичными данными без лицензионных ограничений, что дает фундаментальное конкурентное преимущество по стоимости.

### Модель ценообразования для пользователей

Предлагаю следующую структуру тарифов, основанную на вашей себестоимости:

```mermaid
classDiagram
    class RequestType {
        <<enumeration>>
        SIMPLE_SEARCH
        LEGAL_GRAPH
        RAG_ANALYSIS
    }
    
    class PricingTier {
        string name
        int monthly_quota
        decimal price_per_request
        decimal monthly_fee
        +calculate_cost()
    }
    
    class CostStructure {
        decimal zakononline_cost
        decimal llm_cost
        decimal margin_multiplier
        +total_user_price()
    }
    
    RequestType --> CostStructure
    PricingTier --> CostStructure
```

**Tier 1: Starter (до 1000 запросов/мес)**
- Фикс: 2000 грн/мес + доплата за превышение
- Включает: простые поиски
- Целевая аудитория: индивидуальные юристы

**Tier 2: Professional (1000-10000 запросов/мес)**
- Фикс: 8000 грн/мес + доплата
- Включает: поиски + Legal Graph
- Целевая аудитория: малые юрфирмы

**Tier 3: Enterprise (10K+ запросов/мес)**
- Индивидуальный расчет
- Включает: все функции + приоритетная поддержка
- Целевая аудитория: крупные компании, суды

### Рекомендации по оптимизации себестоимости

**1. Кэширование промптов (Prompt Caching)**
OpenAI недавно внедрила prompt caching, который снижает стоимость повторяющихся промптов на 50-90%. Для вашего случая это критично, так как:
- Системный промпт для Legal Graph один и тот же
- Инструкции по нормализации повторяются

**2. Batch API (50% скидка)**
Для некритичных по времени задач (например, ночное построение графов) можно использовать Batch API OpenAI со скидкой 50%.

**3. Стратегия выбора модели**
- GPT-4o mini: для нормализации, извлечения сущностей (Layer 2)
- GPT-4o: для Legal Graph, сложного анализа (Layer 3, Layer 4)
- Потенциальная экономия: до 70% на рутинных задачах

**4. Агрегация запросов к ЗаконОнлайн**
Достичь порога 50K+ запросов/мес для снижения цены до 0.10 грн. При текущей себестоимости переход с 0.29 на 0.10 грн даст экономию **0.19 грн на каждом вызове API**.

### Итоговая формула себестоимости

Для вашего MCP сервера себестоимость одного запроса составляет:

**Cost = C_zakononline × N_api_calls + C_llm_input × T_input + C_llm_output × T_output**

Где:
- C_zakononline: стоимость одного вызова ЗаконОнлайн (0.10-0.30 грн в зависимости от объема)
- N_api_calls: количество вызовов API для данного запроса
- C_llm_input: стоимость input токена (0.0065-0.109 грн/1K в зависимости от модели)
- T_input: количество input токенов в тысячах
- C_llm_output: стоимость output токена (0.0261-0.435 грн/1K)
- T_output: количество output токенов в тысячах

**Margin multiplier:** Рекомендую использовать множитель 3-5x для B2C и 2-3x для B2B/Enterprise тарифов. Это покроет:
- Инфраструктуру (Kafka, Redis, PostgreSQL, S3)
- Разработку и поддержку
- Маркетинг и продажи
- Прибыль

